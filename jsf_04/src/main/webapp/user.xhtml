<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core">
<h:head>
  <title>Użytkownik</title>
</h:head>
<h:body>
  <h:link outcome="index.xhtml" value="← Powrót do listy"/>

  <h2>Wybrany użytkownik (sesja)</h2>
  <h:panelGroup rendered="#{not empty kadromierzBean.selectedUser}">
    <p><b>ID:</b> #{kadromierzBean.selectedUser.id}</p>
    <p><b>Username:</b> #{kadromierzBean.selectedUser.username}</p>
    <p><b>Role:</b> #{kadromierzBean.selectedUser.role}</p>
  </h:panelGroup>

  <hr/>

  <h2>Grafik (tabela, kolekcja z DB)</h2>
  <h:dataTable value="#{kadromierzBean.schedules}" var="s" border="1">
    <h:column><f:facet name="header">Data</f:facet>#{s.shiftDate}</h:column>
    <h:column><f:facet name="header">Start</f:facet>#{s.shiftStart}</h:column>
    <h:column><f:facet name="header">Koniec</f:facet>#{s.shiftEnd}</h:column>
  </h:dataTable>

  <h3>Dodaj wpis do grafiku (POST)</h3>
  <h:form method="post">
    <p>Data (YYYY-MM-DD): <h:inputText value="#{kadromierzBean.newSchedule.shiftDate}"/></p>
    <p>Start (HH:MM): <h:inputText value="#{kadromierzBean.newSchedule.shiftStart}"/></p>
    <p>Koniec (HH:MM): <h:inputText value="#{kadromierzBean.newSchedule.shiftEnd}"/></p>
    <h:commandButton value="Dodaj" action="#{kadromierzBean.addSchedule}"/>
  </h:form>

  <hr/>

  <h2>Zmiany pracy (shifts)</h2>
  <h:form>
    <h:commandButton value="Start zmiany (POST)" action="#{kadromierzBean.startShift}"/>
  </h:form>

  <h:dataTable value="#{kadromierzBean.shifts}" var="sh" border="1">
    <h:column><f:facet name="header">ID</f:facet>#{sh.id}</h:column>
    <h:column><f:facet name="header">Start</f:facet>#{sh.startTime}</h:column>
    <h:column><f:facet name="header">Koniec</f:facet>#{sh.endTime}</h:column>
    <h:column>
      <f:facet name="header">Akcja</f:facet>
      <h:form rendered="#{empty sh.endTime}">
        <h:commandButton value="Zakończ" action="#{kadromierzBean.endShift(sh.id)}"/>
      </h:form>
    </h:column>
  </h:dataTable>

</h:body>
</html>
